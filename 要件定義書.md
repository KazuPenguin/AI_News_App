# 要件定義書：AI Research OS (Next-Gen AI Learning Platform)

## 1. プロジェクト概要
最新のAI/LLM論文および技術レポートを収集・解析し、単なる要約を超えた「技術的深化」と「市場価値分析」を同時に提供する、エンジニア・研究者・戦略家のための知的生産プラットフォーム。

### 1.1 背景
LLM分野の研究速度は極めて速く、特にシステムアーキテクチャ（HPC, 分散学習）やエンジニアリング（RAG, Agent）領域の論文を網羅的に追うことは困難である。既存の論文アプリではノイズが多く、個人の関心領域（システム・インフラ寄り）に特化したフィルタリングが機能していない。

### 1.2 目的
arXivから毎日発行される膨大な論文の中から、**「基盤モデル」「学習手法」「エンジニアリング」「インフラ」「評価」「規制」**の6大カテゴリに合致し、かつ**「HPC/システム実装」の視点を持つ高品質な論文**のみを自動で抽出し、アプリへ配信する。

### 1.3 最重要制約（KGI）
* **トークンコストの最小化:** 全論文をLLMに読ませるのではなく、メタデータとベクトル検索による事前フィルタリングを徹底し、LLM利用料を極小化する。
* **検索漏れの防止（Recall確保）:** キーワード検索で広めに取得し、ベクトルで絞る「漏斗（ファンネル）型」アーキテクチャを採用する。

## 2. ターゲットユーザー
- 一次情報（論文）から最新技術を学びたいエンジニア・研究者
- 論文の数式や擬似コードを即座に評価したいHPCスペシャリスト
- 技術動向を市場価値と結びつけて管理したい戦略的開発者
- AIの全体の流れを抑え、ビジネスの流れを掴みたい人たち

## 3. システムアーキテクチャ（論文自動キュレーション）
本機能は、バックグラウンド（FastAPI + pgvector）で定期実行されるバッチ処理として実装する。

### 3.1 処理フロー（3段階フィルタリング）
1.  **収集フェーズ (Level 1):** arXiv APIによる広範なキーワード検索（コスト: 0）
2.  **選別フェーズ (Level 2):** pgvectorを用いた「アンカーベクトル」との類似度判定（コスト: 低・計算のみ）
3.  **分析フェーズ (Level 3):** 軽量LLMによる最終判定と構造化データの生成（コスト: トークン消費）
4.  **図表抽出 (Post-L3):** L3通過論文のPDFから図表を自動抽出し、S3に保存（コスト: S3ストレージ）

## 4. 機能要件

### 4.1 データ収集機能 (Level 1: Keyword Filtering)
* **取得ソース:** arXiv API
* **対象カテゴリ:** `cs.CL`, `cs.LG`, `cs.DC` (Distributed Computing), `cs.AI`, `cs.SE`, `cs.CR`, `cs.AR` (Hardware), `cs.CY`
* **検索ロジック:** 以下の6カテゴリに関連するキーワード群をOR条件で結合し、広めに取得する。
    * *Foundation Models:* Transformer, Mamba, SSM, MoE
    * *Training:* RLHF, DPO, PEFT, LoRA
    * *Engineering:* RAG, Agent, Prompt Engineering
    * *Infrastructure:* vLLM, KV Cache, Quantization, Edge AI, GPU
    * *Evaluation:* Leaderboard, Hallucination, Jailbreak
    * *Regulation:* AI Act, Copyright

### 4.2 ベクトル選別機能 (Level 2: Semantic Filtering)
* **埋め込み生成:** 取得した論文の `Title` + `Abstract` をベクトル化する（OpenAI `text-embedding-3-small` 等を使用）。
* **アンカー判定:** 事前に定義した「6つのカテゴリ定義文」のベクトル（アンカー）と、論文ベクトルのコサイン類似度を計算する。
* **閾値判定:** いずれかのアンカーとの類似度が閾値（例: 0.4）を超える論文のみを次工程へ回す。これにより、キーワードは一致しても文脈が異なるノイズ（言語学的解析など）を除外する。

### 4.3 配信対象カテゴリ定義（アンカー定義）
以下の6つの定義文をベクトル化し、フィルタリングの基準（アンカー）とする。

| ID | カテゴリ名 | 定義・含有キーワード |
| :--- | :--- | :--- |
| **1** | **基盤モデル & アーキテクチャ** | 最先端のモデル構造。Transformer代替（Mamba, RWKV）、MoE、マルチモーダル、推論特化モデル（OpenAI o1等）。 |
| **2** | **学習 & チューニング** | モデルの賢さや適応性の向上。Post-training (RLHF, DPO)、Chain of Thought、効率的学習 (LoRA, QLoRA, Model Merge)。 |
| **3** | **アプリケーションエンジニアリング** | 実装技術。RAG (GraphRAG, Hybrid Search)、自律エージェント、マルチエージェントシステム、Prompt Optimization (DSPy)。 |
| **4** | **インフラ & 推論最適化** | **最重要注力領域。** 高速推論 (vLLM, TGI)、メモリ管理 (PagedAttention, KV Cache)、量子化、エッジAI、分散学習システム。 |
| **5** | **評価 & 安全性** | モデル性能評価 (Benchmarks, Leaderboards)、ジェイルブレイク対策、ハルシネーション検知、バイアス評価。 |
| **6** | **規制 & ビジネス** | AI規制法案 (EU AI Act)、著作権問題、学習データの権利関係、透かし技術。 |

### 4.4 LLM分析・詳細解説生成 (Level 3 & App Gen)
 Level 2を通過した論文に対して、以下の処理を行う。
* **適合判定・分類:** 軽量モデル（Gemini 1.5 Flash / gpt-4o-mini）により、本当に指定カテゴリに合致するか最終チェックし、カテゴリIDを付与。
* **エンジニア向け要約:** 「技術的な要点」に絞った日本語1行要約を生成。
* **専門家レビュー (詳細解説):** アプリ表示用に、以下のエージェントが多角的に解説を生成する。
    * 「AIエンジニア担当」
    * 「数学担当」
    * 「ビジネス担当」
* **視覚的解説:** 論文の中身を要約したわかりやすい図の作成（Nano banana）。
* **レベル別レビュー:** 初学者〜プロまで理解できる3段階のレベル構成。

### 4.5 論文図表抽出機能 (Post-L3)
L3で `is_relevant = true` と判定された論文に対して、PDFから図表を自動抽出する。
* **PDF取得:** arXivのPDF URLからダウンロード（バッチ処理内で実行）。
* **図表抽出:** PyMuPDF (fitz) を用いてPDF内の画像オブジェクトを抽出する。
* **フィルタリング:** 小さすぎるアイコン・ロゴ（幅・高さ < 100px）を除外。
* **保存先:** S3バケット（`s3://{bucket}/figures/{arxiv_id}/fig_{n}.png`）に保存。
* **配信:** CloudFront経由でアプリに配信（キャッシュ有効期間: 30日）。
* **メタデータ:** 抽出した図の枚数・S3パス・サイズを `paper_figures` テーブルに記録。
* **コスト目安:** 1論文あたり平均3〜5枚 × 日次30件 = ~100〜150枚/日。S3保存コスト月額 ~$0.05以下。

### 4.6 データベース格納機能
* 以下のデータを `papers` テーブルに保存する。
    * 書誌情報（タイトル、著者、arXiv ID、PDF URL）
    * Abstract本文・ベクトル（pgvector型）
    * 分析結果（カテゴリID、適合度スコア、日本語要約、詳細解説）
    * 発行日、取得日時
* 抽出した図表のメタデータを `paper_figures` テーブルに保存する。
    * 論文ID、S3キー、画像サイズ、表示順序

### 4.7 モバイルフロントエンド
* **クロスプラットフォーム:** React Native (Expo) によるiOS/Android両対応。
* **検索設定機能:** 自分の興味ある分野の論文を絞り込みで検索。
* **ホーム画面:** タイムライン形式で最新論文を紹介。無限スクロール、プルリフレッシュ。
* **論文詳細画面:** 研究背景、新規性、実験結果、ビジネス影響などをセクション分けして表示。**PDF抽出図表を要約と共にインラインで表示。**
* **お気に入り機能:** ブックマークと履歴管理。

### 4.8 その他の機能
* **登録・ログイン:** SNSアカウント（Google/Apple）対応。
* **設定:** 難易度設定、統計表示（閲覧数等）。

## 5. 非機能要件

### 5.1 運用・保守（DevOps）
* **IaC:** AWS CDK (TypeScript) による全インフラのコード化。
* **CI/CD:** GitHub Actions + Fastlane によるストアビルド・自動配信の構築。
* **Observability:** CloudWatch / OpenTelemetry による推論コストとエラーレートの可視化。

### 5.2 性能・効率性
* **実行頻度:** 1日1回（UTC時間のarXiv更新に合わせて実行）。
* **コスト目標:** 1日あたりのLLMトークン消費量を最小限に抑える（フィルタ通過率 10%以下を目安）。
* **レスポンス:** バッチ処理のため即時性は求めないが、アプリ側のレスポンスは1秒以内とする。

### 5.3 拡張性・保守
* **カテゴリ追加:** アンカーベクトルをDBに追加するだけで、コード変更なしに新カテゴリに対応可能。
* **ログ出力:** 各フェーズ（L1, L2, L3）で除外・通過数を記録し、フィルタ強度を調整可能にする。

### 5.4 UX/UI
* **高い再現性・整合性:** LaTeX形式の数式や擬似コードの文字化け欠損を防ぎ（98%以上の精度）、図表と解説を正しく紐付ける。
* **セキュリティー:** ユーザー情報を高度に保護する。

## 6. 技術スタック

| カテゴリ | 選定技術 |
| :--- | :--- |
| **Frontend** | React Native (Expo), Tailwind CSS (NativeWind) |
| **Backend** | Lambda / FastAPI (Python) |
| **Database** | Amazon RDS for PostgreSQL (pgvector) |
| **External API** | arXiv API, Google AI Studio (Gemini), OpenAI API |
| **Infrastructure** | AWS (Bedrock, S3, CloudFront, Cognito) |
| **PDF処理** | PyMuPDF (fitz) — PDF図表抽出 |
| **Orchestration** | Gemini 2.0 Flash PDF全文分析（シングルパス方式） |
| **Container** | Docker |
| **CI/CD** | GitHub Actions, AWS CDK |

## 7. 搭載画面
(構成案は既存のまま維持)

### 初回起動画面: アプリの初回起動時に、使い方について5枚程度のスライド（横スクロール）
- **画面遷移先:** 登録画面、ログイン画面

### 登録画面: アプリのアカウント登録の画面
- **SNSログイン機能** GoogleやAppleでログイン可能に
- **入力情報:** メールアドレス、パスワード

### 登録画面-メールアドレス認証: メールアドレス認証のコードを入力する画面（SNS登録の場合は不要）

### ホーム画面：　タイムライン形式で最新の論文を紹介する
- **論文のタイトルと簡易な要約:** 論文のタイトルと簡易の要約を表示（そのセクションをタップすると詳細へ）、論文の種類を色を分けて表示、いいねもここから押せるように。**閲覧済みの論文はタイトルをグレーアウトして表示。**
- **絞り込み機能:** 登録期間や論文の種類によって絞り込みを可能に
- **フッター:** フッターには「ホーム」、「お気に入り」、「設定」の3項目を表示
- **技術的要件:** 無限スクロール、プルリフレッシュ、スケルトンスクリーン

### 論文詳細画面: 論文の詳細を紹介
- **記載内容:** 上からタイトル、その横に種類、筆頭著者、所属、要約画像、その下に論文の紹介
- **論文図表:** PDFから自動抽出した図表を、関連するセクション内もしくは要約直後に横スクロールカルーセルで表示。タップで拡大。
- **詳細のセクション:** 詳細のセクションは「研究の背景」「概要」「新規性」「技術的な内容」「理論的な根拠」「実験結果」「ビジネスに与える影響」からその論文にふさわしいものを自動で選択して表示
- **フッター:** フッターはなし
- **ヘッダー:** ヘッダーの左上はホームに戻る、右上は「スター」と「レベル切り替えボタン」
- **UX:** 横スライドでホームに戻れるように

### お気に入り画面: お気に入りにいれた論文を表示
- **記載内容:** 基本的な構造はタイムラインと同じ、いついいねをしたかをみれるように

### 設定画面
- **記載内容:** ユーザーに関する統計を見れる、「見た論文の数」「いいねの数」
- **設定できる内容:** デフォルトで設定する難易度、言語設定

## 8. 将来的な拡張機能 (Future Roadmap)

### 8.1 ワードベクトル検索での論文検索
* **概要:** ユーザーが入力した文章（クエリ）をベクトル化し、論文の要約やタイトルと類似度比較を行うことで、キーワードが完全に一致しなくとも意図した論文を検索可能にする。

### 8.2 チャットボット（知りたい内容を聞いたらおおまかな内容を答え、関連する論文をおすすめする機能）
* **概要:** ユーザーとの対話を通じて、知りたいトピックに関する概要説明を行い、同時にそのトピックに関連する学習済み論文をレコメンドする。
* **機能詳細:** RAG（Retrieval-Augmented Generation）技術を活用し、論文データベースから根拠となる情報を抽出して回答を生成する。

### 8.2 課金機能を作る

* **無料ユーザーと有料ユーザー:**

### 8.3 管理用webアプリ作りたいねこれ